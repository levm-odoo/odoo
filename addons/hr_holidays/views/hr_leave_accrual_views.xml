<?xml version='1.0' encoding='UTF-8' ?>
<odoo>
    <record id="hr_accrual_level_view_form" model="ir.ui.view">
        <field name="name">hr.leave.accrual.level.form</field>
        <field name="model">hr.leave.accrual.level</field>
        <field name="arch" type="xml">
            <form string="Accrual Level">
                <sheet>
                    <div colspan="2">
                        <field name="can_modify_value_type" invisible="1"/>
                    </div>
                    <div class="accrual">
                        Employee will accrue
                        <field  class="me-1" style="width: 1ch" name="added_value" widget="float_without_trailing_zeros"/>
                        <field  class="me-1" name="added_value_type" readonly="not can_modify_value_type" widget="selection_fit_option"/>
                        <field  name="frequency" widget="selection_fit_option"/>
                        <span name="weekly" invisible="frequency != 'weekly'">
                            on
                            <field  name="week_day" widget="selection_fit_option"/>
                        </span>
                        <span name="monthly" invisible="frequency != 'monthly'">
                            on the
                            <field  name="first_day_display" widget="selection_fit_option"/>
                            of the month
                        </span>
                        <span name="bimonthly" invisible="frequency != 'bimonthly'" style="width: 100%">
                            on the
                            <field  name="first_day_display" widget="selection_fit_option"/>
                            and on the
                            <field  name="second_day_display" widget="selection_fit_option"/>
                            of the month
                        </span>
                        <span name="biyearly" invisible="frequency != 'biyearly'">
                            on the
                            <field  name="first_month_day_display" widget="selection_fit_option"/> of <field  name="first_month" widget="selection_fit_option"/>
                            and
                            <field  name="second_month_day_display" widget="selection_fit_option"/> of <field  name="second_month" widget="selection_fit_option"/>
                        </span>
                        <span name="yearly" invisible="frequency != 'yearly'">
                            on the
                            <field name="yearly_day_display" widget="selection_fit_option"/> of <field  name="yearly_month" widget="selection_fit_option"/>
                        </span>
                        based on
                        <field name="based_on" widget="selection_fit_option"/>
                        <br/>
                        This milestone will be reached
                        <field class="me-1" name="milestone_date" widget="selection_fit_option"/>
                        <span invisible="milestone_date != 'after'">
                            <field class="me-1" style="width: 1ch" name="start_count" widget="integer_auto_width"/>
                            <field name="start_type" widget="selection_fit_option"/>
                            from the start of allocation
                        </span>
                        <br/>
                        After a year, unused time off will be
                        <field class="me-1" name="action_with_unused_accruals" widget="selection_fit_option"/>
                        <span invisible="action_with_unused_accruals != 'lost'">Allocation amount will be reset to 0</span>
                        <span invisible="action_with_unused_accruals != 'maximum'">
                            of
                            <field class="me-1" style="width: 1ch" name="postpone_max_days" widget="integer_auto_width"/>
                            <field name="added_value_type" nolabel="1" readonly="1" force_save="1"/>
                        </span>
                        <br/>
                        Define a carry over validity?
                        <field name="accrual_validity" widget="boolean_labeled" options="{'false_label': 'No.', 'true_label': 'Yes,'}" />
                            <span invisible="not accrual_validity">
                                the days carried over will be effective for
                                <field class="me-1" style="width: 1ch" name="accrual_validity_count" widget="integer_auto_width"/>
                                <field class="me-1" name="accrual_validity_type" widget="selection_fit_option"/>
                            </span>
                        <br/>
                        <span invisible="action_with_unused_accruals == 'lost'">
                            Define a yearly cap?
                            <field name="cap_accrued_time_yearly" widget="boolean_labeled" options="{'false_label': 'No.', 'true_label': 'Yes,'}"/>
                                <span invisible="not cap_accrued_time_yearly">
                                    plan will be on hold if allocation's amount reach
                                    <field class="me-1" style="width: 1ch" name="maximum_leave_yearly" widget="float_without_trailing_zeros"/>
                                    <field name="added_value_type" readonly="1"/>
                                    of available time.
                                </span>
                            <br/>
                            Define a milestone cap?
                            <field name="cap_accrued_time" widget="boolean_labeled" options="{'false_label': 'No.', 'true_label': 'Yes,'}"/>
                                <span invisible="not cap_accrued_time">
                                    plan will be on hold if the sum of allocated time reach
                                    <field class="me-1" style="width: 1ch" name="maximum_leave" widget="float_without_trailing_zeros"/>
                                    <field name="added_value_type" readonly="1"/>
                                    of available time.
                                </span>
                        </span>
                    </div>
                </sheet>
            </form>
        </field>
    </record>
    <record id="hr_accrual_plan_view_tree" model="ir.ui.view">
        <field name="name">hr.leave.accrual.plan.list</field>
        <field name="model">hr.leave.accrual.plan</field>
        <field name="arch" type="xml">
            <list string="Accrual Plans">
                <field name="name"/>
                <field name="level_count"/>
                <field name="employees_count"/>
            </list>
        </field>
    </record>
    <record id="hr_accrual_plan_view_form" model="ir.ui.view">
        <field name="name">hr.leave.accrual.plan.form</field>
        <field name="model">hr.leave.accrual.plan</field>
        <field name="arch" type="xml">
            <form string="Accrual Plan">
                <field name="active" invisible="1"/>
                <field name="show_transition_mode" invisible="1" />
                <sheet>
                    <div class="oe_button_box" name="button_box" invisible="not id" >
                        <button name="action_open_accrual_plan_employees" type="object" class="oe_stat_button" icon="fa-users" invisible="employees_count == 0" groups="hr.group_hr_user">
                            <field name="employees_count" widget="statinfo"/>
                        </button>
                    </div>
                    <widget name="web_ribbon" title="Archived" bg_color="bg-danger" invisible="active"/>
                    <div class="oe_title">
                        <h1><field name="name" placeholder="Name"/></h1>
                        <h2 groups="base.group_multi_company"><field name="company_id" placeholder="Company" options="{'no_create': True}"/></h2>
                    </div>
                    <group>
                        <group string="Configuration" class="mt-0 accrual">
                            <div colspan="2">
                                When the time is accrued?
                                <field nolabel="1" name="accrued_gain_time" widget="radio"/>
                                <br/>It is based on the worked time?
                                <field nolabel="1" name="is_based_on_worked_time" widget="boolean_labeled" options="{'false_label': 'No, always consider accrual period as a whole', 'true_label': 'Yes, prorate based on the taken time offs on that period'}" readonly="accrued_gain_time == 'start'"/>
                                <br/>Do you need a carry-over of the accrued days from one year to another?
                                <field nolabel="1" name="is_carryover" widget="boolean_labeled" options="{'false_label': 'No', 'true_label': 'Yes'}"/>
                                <span name="carryover" invisible="not is_carryover">
                                    <br/>When do you want the accrued time left to be carried-over?
                                    <field nolabel="1" name="carryover_date" widget="radio_followed_by_element" options="{'links': {'other': 'carryover_custom_date' }}"/>
                                    <span id="carryover_custom_date" invisible="carryover_date != 'other'">
                                        the
                                        <field name="carryover_day_display" widget="selection_fit_option"/>
                                        of
                                        <field name="carryover_month" widget="selection_fit_option"/>
                                    </span>
                                </span>
                                <span invisible="not show_transition_mode">
                                    <br/>Switch employees to the new accrual level :
                                    <field nolabel="1" name="transition_mode" widget="radio"/>
                                </span>
                            </div>
                        </group>
                        <group string="Summary">
                        <div colspan="2">
                            <div>
                                <field class="w-100" name="summary" readonly="1"/>
                            </div>
                        </div>
                            </group>
                    </group>
                    <span class="oe_grey" invisible="1">
                    </span>
                    <div class="o_hr_holidays_hierarchy">
                        <h3>Milestones</h3>
                        <div class="o_view_nocontent" style="position: relative;" invisible="level_ids">
                            <div class="o_nocontent_help">
                                <p class="o_view_nocontent_smiling_face">
                                    No milestones on the plan yet. Let's create a new one
                                </p>
                                <button name="action_open_accrual_plan_level" type="object" class="btn btn-primary" string="Create a milestone"/>
                            </div>
                        </div>
                        <button name="action_open_accrual_plan_level" type="object" class="btn btn-secondary" string="Add a milestone"/>
                    </div>
                </sheet>
            </form>
        </field>
    </record>
    <record id="hr_accrual_plan_view_search" model="ir.ui.view">
        <field name="name">hr.leave.accrual.plan.search</field>
        <field name="model">hr.leave.accrual.plan</field>
        <field name="arch" type="xml">
            <search string="Group By">
                <filter string="Archived" name="inactive" domain="[('active','=',False)]"/>
                <filter string="Company" name='company_id' context="{'group_by':'company_id'}" groups="base.group_multi_company"/>
            </search>
        </field>
    </record>

    <record id="open_view_accrual_plans" model="ir.actions.act_window">
        <field name="name">Accrual Plans</field>
        <field name="res_model">hr.leave.accrual.plan</field>
        <field name="view_mode">list,form</field>
    </record>

</odoo>
